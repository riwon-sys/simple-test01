<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>추가매수 간단 계산기</title>
<link rel="manifest" href="manifest.json" />
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => navigator.serviceWorker.register('sw.js'));
  }
</script>
<style>
  body {font-family: Arial, sans-serif; padding:20px; max-width:820px; margin:auto;}
  header { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
  header h1 { font-size:18px; margin:0; }
  .pos { color:#0a7a0a; font-weight:bold; }
  .neg { color:#c72626; font-weight:bold; }
  fieldset { border:1px solid #ccc; padding:12px; margin:14px 0; border-radius:8px; }
  legend { font-weight:bold; }
  input, select { width:100%; padding:8px; margin-top:4px; }
  button { width:100%; padding:12px; margin-top:10px; background:#111; color:#fff; border:none; border-radius:6px; }
  .cards { display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-top:16px; }
  .card { border:1px solid #aaa; border-radius:8px; padding:12px; }
  .kv { display:flex; justify-content:space-between; margin:4px 0; }
</style>
</head>
<body>
<header>
  <h1><span id="coinLabel">코인명</span> <small id="unitLabel">(KRW)</small></h1>
  <div>
    <div id="topPnL">-</div>
    <small id="topRoi">-</small>
  </div>
</header>
<fieldset>
  <legend>보유 정보</legend>
  <label>코인명</label>
  <input id="coin" placeholder="예) WLFI" />
  <label>보유수량 *</label>
  <input id="holdQty" type="number" step="any" />
  <label>매수평균가 *</label>
  <input id="holdAvg" type="number" step="any" />
  <label>단위 *</label>
  <select id="unit"><option value="KRW">KRW</option><option value="USD">USD</option></select>
  <label>현재가 *</label>
  <input id="now" type="number" step="any" />
</fieldset>
<fieldset>
  <legend>추가매수</legend>
  <label>추가매수 단가 *</label>
  <input id="addPrice" type="number" step="any" />
  <label>추가매수 수량 (선택)</label>
  <input id="addQty" type="number" step="any" />
  <label>추가매수 매수금액 (선택)</label>
  <input id="addInvest" type="number" step="any" />
  <button id="calcBtn">계산하기</button>
</fieldset>
<div class="cards">
  <div class="card">
    <h3>추가매수 전</h3>
    <div class="kv"><span>보유수량</span><b id="bQty">-</b></div>
    <div class="kv"><span>매수평균가</span><b id="bAvg">-</b></div>
    <div class="kv"><span>매수금액</span><b id="bInvest">-</b></div>
    <div class="kv"><span>평가금액</span><b id="bEval">-</b></div>
    <div class="kv"><span>평가손익</span><b id="bPnL">-</b></div>
    <div class="kv"><span>수익률</span><b id="bRoi">-</b></div>
  </div>
  <div class="card">
    <h3>추가매수 후</h3>
    <div class="kv"><span>보유수량</span><b id="aQty">-</b></div>
    <div class="kv"><span>매수평균가</span><b id="aAvg">-</b></div>
    <div class="kv"><span>매수금액</span><b id="aInvest">-</b></div>
    <div class="kv"><span>평가금액</span><b id="aEval">-</b></div>
    <div class="kv"><span>평가손익</span><b id="aPnL">-</b></div>
    <div class="kv"><span>수익률</span><b id="aRoi">-</b></div>
  </div>
</div>
<script>
const $=id=>document.getElementById(id);
function signed(v,u){const cls=v>=0?'pos':'neg';const sign=v>=0?'+':'';return `<span class="${cls}">${sign}${v.toLocaleString()} ${u}</span>`;}
function signedPct(p){const cls=p>=0?'pos':'neg';const sign=p>=0?'+':'';return `<span class="${cls}">${sign}${p.toFixed(2)} %</span>`;}
function calc(){
  const coin=$('coin').value||'코인명';
  const unit=$('unit').value; $('coinLabel').textContent=coin; $('unitLabel').textContent=`(${unit})`;
  const holdQty=+$('holdQty').value, holdAvg=+$('holdAvg').value, now=+$('now').value;
  const addPrice=+$('addPrice').value, addQtyI=+$('addQty').value, addInvI=+$('addInvest').value;
  if(!holdQty||!holdAvg||!now||!addPrice)return;
  let addQty=0, addInv=0;
  if(addInvI>0){addInv=addInvI;addQty=addInv/addPrice;} else if(addQtyI>0){addQty=addQtyI;addInv=addQty*addPrice;} else return;
  const bInv=holdQty*holdAvg, bEval=holdQty*now, bPnL=bEval-bInv, bRoi=bInv?(bPnL/bInv*100):0;
  $('topPnL').innerHTML=signed(bPnL,unit); $('topRoi').innerHTML=signedPct(bRoi);
  $('bQty').textContent=holdQty; $('bAvg').textContent=holdAvg+" "+unit; $('bInvest').textContent=bInv+" "+unit; $('bEval').textContent=bEval+" "+unit; $('bPnL').innerHTML=signed(bPnL,unit); $('bRoi').innerHTML=signedPct(bRoi);
  const aQty=holdQty+addQty, aInv=bInv+addInv, aAvg=aQty?aInv/aQty:0, aEval=aQty*now, aPnL=aEval-aInv, aRoi=aInv?(aPnL/aInv*100):0;
  $('aQty').textContent=aQty.toFixed(4); $('aAvg').textContent=aAvg.toFixed(2)+" "+unit; $('aInvest').textContent=aInv+" "+unit; $('aEval').textContent=aEval+" "+unit; $('aPnL').innerHTML=signed(aPnL,unit); $('aRoi').innerHTML=signedPct(aRoi);
}
$('calcBtn').addEventListener('click',calc);
</script>
</body>
</html>